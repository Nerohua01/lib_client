"use strict";(self["webpackChunklib_client"]=self["webpackChunklib_client"]||[]).push([[590],{6590:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var a=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[[t("div",{staticStyle:{"margin-top":"20px","margin-left":"40px","margin-bottom":"20px"}},[t("label",{staticStyle:{"font-family":"'宋体'","font-weight":"bolder"}},[e._v("快速查询：")]),t("span",[t("el-input",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入用户名",clearable:""},on:{input:e.refreshTable},model:{value:e.seluid,callback:function(t){e.seluid=t},expression:"seluid"}}),t("el-input",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入姓名",clearable:""},on:{input:e.refreshTable},model:{value:e.seluname,callback:function(t){e.seluname=t},expression:"seluname"}})],1),t("div",{staticStyle:{float:"right"}},[t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.addUser}},[e._v("新增")]),t("el-button",{staticStyle:{"margin-right":"60px"},attrs:{type:"danger"},on:{click:e.deleteByIds}},[e._v("批量删除")])],1)]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","header-cell-style":{background:"#f4f4f4",color:"#80878f"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"uid",label:"用户名",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"uname",label:"姓名",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"uphone",label:"电话",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"uidentity",label:"身份",align:"center",sortable:""}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"warning",size:"small",plain:""},on:{click:function(t){return e.editUser(s.row)}}},[e._v("修改")]),t("el-popconfirm",{attrs:{"confirm-button-text":"确定","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定要删除吗？"},on:{confirm:function(t){return e.deleteOne(s.row)}}},[t("el-button",{attrs:{slot:"reference",type:"danger",size:"small",plain:""},slot:"reference"},[e._v(" 删除")])],1)]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center","margin-top":"8px"},attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.sizePage,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],t("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"25%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"user",staticStyle:{"text-align":"center"},attrs:{rules:e.rules,model:e.user,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"uid"}},[t("el-input",{staticStyle:{width:"218px"},attrs:{disabled:e.flag,placeholder:"请输入用户名"},on:{blur:e.checkUid},model:{value:e.user.uid,callback:function(t){e.$set(e.user,"uid",t)},expression:"user.uid"}})],1),t("el-form-item",{attrs:{label:"姓名",prop:"uname"}},[t("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入用户姓名"},model:{value:e.user.uname,callback:function(t){e.$set(e.user,"uname",t)},expression:"user.uname"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"uphone"}},[t("el-input",{staticStyle:{width:"218px"},attrs:{placeholder:"请输入用户手机号"},model:{value:e.user.uphone,callback:function(t){e.$set(e.user,"uphone",t)},expression:"user.uphone"}})],1),t("el-form-item",{attrs:{label:"身份",prop:"uidentity"}},[t("el-select",{staticStyle:{width:"218px"},attrs:{clearable:""},model:{value:e.user.uidentity,callback:function(t){e.$set(e.user,"uidentity",t)},expression:"user.uidentity"}},[t("el-option",{attrs:{value:"user",label:"普通用户"}}),t("el-option",{attrs:{value:"admin",label:"管理员"}})],1)],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{staticStyle:{width:"218px"},attrs:{"show-password":"",placeholder:"请输入用户登录密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),t("el-form-item",[t("el-button",{staticStyle:{"margin-right":"55px"},attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交 ")])],1)],1)],1)],2)},l=[],i=(s(7658),s(4161));const r={data(){return{name:"UserManage",currentPage:1,sizePage:10,totalPage:0,seluid:"",seluname:"",multipleSelection:[],tableData:[],dialogVisible:!1,title:"添加学生信息",user:{uid:"",uname:"",uphone:"",uidentity:"",password:""},flag:!1,rules:{uid:[{required:!0,message:"请输入用户名",trigger:"blur"}],uname:[{required:!0,message:"请输入姓名",trigger:"blur"}],uidentity:[{required:!0,message:"请选择用户身份",trigger:"change"}],uphone:[{required:!0,message:"请输入手机号",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}]}}},mounted(){this.refreshTable()},methods:{submitForm(){if(null===this.user||""===this.user.uid||""===this.user.uname||""===this.user.uphone||""===this.user.uidentity||""===this.user.password)this.$message({message:"请填写完整信息",type:"error"});else if(this.flag)i.Z.put("/api/users",this.user).then((e=>{20031===e.data.code?(this.$message({message:"修改成功",type:"success"}),this.dialogVisible=!1,this.refreshTable()):this.$message({message:"修改失败",type:"error"})}));else{const e=this.checkUid();e.then((e=>{e&&i.Z.post("/api/users",this.user).then((e=>{20011===e.data.code?(this.$message({message:"添加成功",type:"success"}),this.dialogVisible=!1,this.refreshTable()):this.$message({message:"添加失败",type:"error"})}))}))}},addUser(){this.cleanForm(),this.title="添加用户",this.dialogVisible=!0,this.flag=!1,this.user={}},editUser(e){this.cleanForm(),this.title="修改用户",this.dialogVisible=!0,this.flag=!0,this.user={...e},this.user.password=""},async checkUid(){try{const e=await i.Z.get("/api/users/id/"+this.user.uid);return 20041!=e.data.code||(this.$message({message:"此账号已存在，请换一个",type:"error"}),!1)}catch(e){return console.log(e),!1}},cleanForm(){this.$nextTick((()=>{this.$refs["user"].clearValidate()})),this.user={}},refreshTable(){i.Z.get("/api/users/page",{params:{page:this.currentPage,size:this.sizePage,uid:this.seluid,uname:this.seluname}}).then((e=>{this.tableData=e.data.records,this.totalPage=e.data.total}))},deleteOne(e){i.Z["delete"]("/api/users/"+e.uid).then((e=>{20021===e.data.code?(this.$message({message:"删除成功",type:"success"}),this.refreshTable()):this.$message({message:"删除失败",type:"error"}),this.refreshTable()}))},handleSelectionChange(e){this.multipleSelection=e},deleteByIds(){0===this.multipleSelection.length?this.$message({message:"请至少选择一项",type:"warning"}):this.$confirm("此操作将永久删除这些数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=[];this.multipleSelection.forEach((t=>{e.push(t.uid)})),i.Z["delete"]("/api/users/ids",{data:e}).then((()=>{this.$message({type:"success",message:"操作成功"}),this.refreshTable()}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSizeChange(e){this.sizePage=e,this.refreshTable()},handleCurrentChange(e){this.currentPage=e,this.refreshTable()}}};var n=r,u=n,o=s(3736),c=(0,o.Z)(u,a,l,!1,null,null,null),h=c.exports}}]);
//# sourceMappingURL=590.b76ed5a5.js.map