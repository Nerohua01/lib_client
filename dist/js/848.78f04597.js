"use strict";(self["webpackChunklib_client"]=self["webpackChunklib_client"]||[]).push([[848],{3848:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var l=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[[t("div",{staticStyle:{"margin-top":"20px","margin-left":"40px","margin-bottom":"20px"}},[t("label",{staticStyle:{"font-family":"'宋体'","font-weight":"bolder"}},[e._v("快速查询：")]),t("span",[t("el-input",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入借阅编号",clearable:""},on:{input:e.refreshTable},model:{value:e.selid,callback:function(t){e.selid=t},expression:"selid"}}),t("el-input",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入用户名",clearable:""},on:{input:e.refreshTable},model:{value:e.seluid,callback:function(t){e.seluid=t},expression:"seluid"}}),t("el-input",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入书籍编号",clearable:""},on:{input:e.refreshTable},model:{value:e.selbid,callback:function(t){e.selbid=t},expression:"selbid"}})],1),t("div",{staticStyle:{float:"right"}},[t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.addUser}},[e._v("新增")]),t("el-button",{staticStyle:{"margin-right":"60px"},attrs:{type:"danger"},on:{click:e.deleteByIds}},[e._v("批量删除")])],1)]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.tableRowClassName,"header-cell-style":{background:"#f4f4f4",color:"#80878f"}},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"100",align:"center"}}),t("el-table-column",{attrs:{prop:"id",label:"记录编号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"uid",label:"用户名",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"bid",label:"书籍编号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"bdate",label:"借阅时间",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"rdate",label:"归还时间",align:"center",sortable:""}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"warning",size:"small",plain:""},on:{click:function(t){return e.editUser(a.row)}}},[e._v("修改")]),t("el-popconfirm",{attrs:{"confirm-button-text":"确定","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定要删除吗？"},on:{confirm:function(t){return e.deleteOne(a.row)}}},[t("el-button",{attrs:{slot:"reference",type:"danger",size:"small",plain:""},slot:"reference"},[e._v(" 删除")])],1)]}}])})],1),t("el-pagination",{staticStyle:{"text-align":"center","margin-top":"8px"},attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.sizePage,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],t("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"25%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"borrow",staticStyle:{"text-align":"center"},attrs:{rules:e.rules,model:e.borrow,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"借阅人",prop:"uid"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"选择用户名"},model:{value:e.borrow.uid,callback:function(t){e.$set(e.borrow,"uid",t)},expression:"borrow.uid"}},e._l(e.userDate,(function(e){return t("el-option",{key:e.uid,attrs:{label:e.uid,value:e.uid}})})),1)],1),t("el-form-item",{attrs:{label:"书籍编号",prop:"bid"}},[t("el-select",{attrs:{filterable:"",clearable:"",placeholder:"选择书籍编号"},model:{value:e.borrow.bid,callback:function(t){e.$set(e.borrow,"bid",t)},expression:"borrow.bid"}},e._l(e.bookDate,(function(e){return t("el-option",{key:e.bid,attrs:{label:e.bid,value:e.bid}})})),1)],1),t("el-form-item",{attrs:{label:"借阅时间",prop:"bdate"}},[t("div",{staticClass:"block"},[t("el-date-picker",{attrs:{type:"datetime",clearable:!1,placeholder:"选择借阅日期时间","default-time":"12:00:00","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.borrow.bdate,callback:function(t){e.$set(e.borrow,"bdate",t)},expression:"borrow.bdate"}})],1)]),t("el-form-item",{attrs:{label:"归还时间",prop:"rdate"}},[t("div",{staticClass:"block"},[t("el-date-picker",{attrs:{type:"datetime",clearable:!1,placeholder:"选择归还日期时间","default-time":"12:00:00","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.borrow.rdate,callback:function(t){e.$set(e.borrow,"rdate",t)},expression:"borrow.rdate"}})],1)]),t("el-form-item",[t("el-button",{staticStyle:{"margin-right":"55px"},attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")])],1)],1)],1)],2)},r=[],i=(a(7658),a(4161));const s={data(){return{borrow:{bid:"",uid:"",bdate:"",rdate:""},userDate:[],bookDate:[],name:"UserManage",currentPage:1,sizePage:10,totalPage:0,selid:"",seluid:"",selbid:"",multipleSelection:[],tableData:[],dialogVisible:!1,title:"",flag:!1,rules:{uid:[{required:!0,message:"请选择用户姓名",trigger:"change"}],bid:[{required:!0,message:"请选择书名",trigger:"change"}],bdate:[{required:!0,message:"请选择借阅时间",trigger:"change"}],rdate:[{required:!1,message:"请选择归还时间",trigger:"change"}]}}},mounted(){this.refreshTable(),i.Z.get("/api/users").then((e=>{this.userDate=e.data.data})),i.Z.get("/api/books").then((e=>{this.bookDate=e.data.data}))},methods:{tableRowClassName({row:e}){return null==e.rdate?"warning-row":"success-row"},submitForm(){""==this.borrow.bdate||null==this.borrow.bdate||""==this.borrow.uid||null==this.borrow.uid||""==this.borrow.bid||null==this.borrow.bid?this.$message({message:"请填写完整信息",type:"error"}):this.flag?i.Z.put("/api/borrows",this.borrow).then((e=>{20031===e.data.code?(this.$message({message:"修改成功",type:"success"}),this.dialogVisible=!1,this.refreshTable()):this.$message({message:"修改失败",type:"error"})})):i.Z.post("/api/borrows",this.borrow).then((e=>{20011===e.data.code?(this.$message({message:"添加成功",type:"success"}),this.dialogVisible=!1,this.refreshTable()):this.$message({message:"添加失败",type:"error"})}))},addUser(){this.cleanForm(),this.title="添加记录",this.dialogVisible=!0,this.flag=!1,this.borrow={}},editUser(e){this.cleanForm(),this.title="修改记录",this.dialogVisible=!0,this.flag=!0,this.borrow={...e}},cleanForm(){this.$nextTick((()=>{this.$refs["borrow"].clearValidate()})),this.borrow={}},refreshTable(){i.Z.get("/api/borrows/page",{params:{page:this.currentPage,size:this.sizePage,id:this.selid,uid:this.seluid,bid:this.selbid}}).then((e=>{this.tableData=e.data.records,this.totalPage=e.data.total}))},deleteOne(e){i.Z["delete"]("/api/borrows/"+e.id).then((e=>{20021===e.data.code?(this.$message({message:"删除成功",type:"success"}),this.refreshTable()):this.$message({message:"删除失败",type:"error"}),this.refreshTable()}))},handleSelectionChange(e){this.multipleSelection=e},deleteByIds(){0==this.multipleSelection.length?this.$message({message:"请至少选择一项",type:"warning"}):this.$confirm("此操作将永久删除这些数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=[];this.multipleSelection.forEach((t=>{e.push(t.id)})),i.Z["delete"]("/api/borrows/ids",{data:e}).then((()=>{this.$message({type:"success",message:"操作成功"}),this.refreshTable()}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSizeChange(e){this.sizePage=e,this.refreshTable()},handleCurrentChange(e){this.currentPage=e,this.refreshTable()}}};var o=s,n=o,d=a(3736),c=(0,d.Z)(n,l,r,!1,null,null,null),b=c.exports}}]);
//# sourceMappingURL=848.78f04597.js.map