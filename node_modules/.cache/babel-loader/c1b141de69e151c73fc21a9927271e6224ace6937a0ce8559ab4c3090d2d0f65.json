{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nconst options = {\n  data() {\n    return {\n      user: {\n        username: '',\n        password: ''\n      }\n    };\n  },\n  methods: {\n    // 登录\n    login() {\n      if (this.nameBlur() === false || this.pwdBlur() === false) {\n        return;\n      }\n      axios.post('/api/login', this.user, {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      }).then(res => {\n        // console.log(res.data);\n        if (res.data.code === 20001) {\n          this.$message({\n            message: res.data.msg,\n            type: 'success'\n          });\n          // 获取到登录响应后，将 token 存储到本地存储中\n          localStorage.setItem('token', res.data.data.token);\n          // this.$store.commit('setToken', res.data.data.token);\n          this.$store.commit('setUser', res.data.data.user);\n          this.$router.push('/home');\n        } else {\n          this.$message({\n            message: res.data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 账号输入框失去焦点\n    nameBlur() {\n      if (this.user.username === '') {\n        this.$message({\n          message: '请输入账号',\n          type: 'error'\n        });\n        return false;\n      } else if (this.user.username.length < 5 || this.user.username.length > 12) {\n        this.$message({\n          message: '账号长度为5-12位',\n          type: 'error'\n        });\n        return false;\n      } else return true;\n    },\n    // 密码输入框失去焦点\n    pwdBlur() {\n      if (this.user.password === '') {\n        this.$message({\n          message: '请输入密码',\n          type: 'error'\n        });\n        return false;\n      } else if (this.user.password.length < 4 || this.user.password.length > 12) {\n        this.$message({\n          message: '密码长度为4-12位',\n          type: 'error'\n        });\n        return false;\n      } else return true;\n    }\n  },\n  mounted() {\n    //在vuex中设置一个flash变量，当flash为true时，刷新页面\n    if (this.$store.state.flash === true) {\n      this.$store.commit('setFlash', false);\n      this.$router.go(0);\n    }\n    this.$nextTick(() => {\n      document.title = '欢迎来到图书信息管理子系统';\n    });\n  }\n};\nexport default options;","map":{"version":3,"names":["axios","options","data","user","username","password","methods","login","nameBlur","pwdBlur","post","headers","then","res","code","$message","message","msg","type","localStorage","setItem","token","$store","commit","$router","push","length","mounted","state","flash","go","$nextTick","document","title"],"sources":["src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"login-wrapper\">\n      <div class=\"header\">登录</div>\n      <form class=\"form-wrapper\" :model=\"user\" action=\"\">\n        <input type=\"text\" name=\"uid\" placeholder=\"账号\" class=\"input-item\"\n               v-model=\"user.username\" v-on:blur=\"nameBlur\">\n        <input type=\"password\" name=\"password\" placeholder=\"密码\" class=\"input-item\"\n               v-model=\"user.password\" v-on:blur=\"pwdBlur\" @keyup.enter=\"login\">\n        <button class=\"btn\" @click=\"login\" type=\"button\">登录</button>\n      </form>\n      <div class=\"msg\">\n        还没有账号？\n        <router-link :to=\"{ path: '/register' }\" key=\"register\">点击注册</router-link>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport axios from 'axios';\n\nconst options = {\n  data() {\n    return {\n      user: {\n        username: '',\n        password: ''\n      }\n    }\n  },\n  methods: {\n    // 登录\n    login() {\n      if (this.nameBlur() === false || this.pwdBlur() === false) {\n        return;\n      }\n      axios.post('/api/login', this.user,{headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }}).then(res => {\n        // console.log(res.data);\n        if (res.data.code === 20001) {\n          this.$message({\n            message: res.data.msg,\n            type: 'success'\n          });\n          // 获取到登录响应后，将 token 存储到本地存储中\n          localStorage.setItem('token', res.data.data.token)\n          // this.$store.commit('setToken', res.data.data.token);\n          this.$store.commit('setUser', res.data.data.user);\n          this.$router.push('/home');\n        } else {\n          this.$message({\n            message: res.data.msg,\n            type: 'error'\n          });\n        }\n      });\n    },\n    // 账号输入框失去焦点\n    nameBlur() {\n      if (this.user.username === '') {\n        this.$message({\n          message: '请输入账号',\n          type: 'error'\n        });\n        return false;\n      } else if(this.user.username.length < 5 || this.user.username.length > 12){\n        this.$message({\n          message: '账号长度为5-12位',\n          type: 'error'\n        });\n        return false;\n      }else\n        return true;\n    },\n    // 密码输入框失去焦点\n    pwdBlur() {\n      if (this.user.password === '') {\n        this.$message({\n          message: '请输入密码',\n          type: 'error'\n        });\n        return false;\n      } else if(this.user.password.length < 4 || this.user.password.length > 12){\n        this.$message({\n          message: '密码长度为4-12位',\n          type: 'error'\n        });\n        return false;\n      } else\n        return true;\n    }\n  },\n  mounted() {\n    //在vuex中设置一个flash变量，当flash为true时，刷新页面\n    if (this.$store.state.flash === true) {\n      this.$store.commit('setFlash', false);\n      this.$router.go(0);\n    }\n    this.$nextTick(() => {\n      document.title = '欢迎来到图书信息管理子系统';\n    });\n  }\n}\nexport default options;\n</script>\n\n<style>\n* {\n  margin: 0;\n  padding: 0;\n}\n\n.container {\n  background-image: linear-gradient(to right, #fbc2eb, #a6c1ee);\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n\n.login-wrapper {\n  background-color: #ffffff;\n  width: 380px;\n  height: 550px;\n  border-radius: 15px;\n  padding: 0 50px;\n  position: relative;\n  left: 50%;\n  top: 15%;\n  transform: translate(-50%, 0%);\n\n}\n\n.header {\n  font-size: 45px;\n  font-weight: bold;\n  text-align: center;\n  line-height: 200px;\n  font-family: '宋体',serif;\n}\n\n.input-item {\n  display: block;\n  width: 100%;\n  margin-bottom: 20px;\n  border: 0;\n  padding: 10px;\n  border-bottom: 1px solid rgb(128, 125, 125);\n  font-size: 15px;\n  outline: none;\n}\n\n.input-item::placeholder {\n  text-transform: uppercase;\n}\n\n.btn {\n  cursor: pointer;\n  border: 0px;\n  font-size: 20px;\n  font-family: '宋体',serif;\n  text-align: center;\n  padding: 10px;\n  width: 100%;\n  margin-top: 40px;\n  border-radius: 8px;\n  background-image: linear-gradient(to right, #a6c1ee, #fbc2eb);\n  color: #000000;\n}\n\n.msg {\n  font-size: 15px;\n  text-align: center;\n  line-height: 88px;\n}\n\na {\n  text-decoration-line: none;\n  color: #005eff;\n}\n</style>\n\n"],"mappings":";AAmBA,OAAAA,KAAA;AAEA,MAAAC,OAAA;EACAC,KAAA;IACA;MACAC,IAAA;QACAC,QAAA;QACAC,QAAA;MACA;IACA;EACA;EACAC,OAAA;IACA;IACAC,MAAA;MACA,SAAAC,QAAA,qBAAAC,OAAA;QACA;MACA;MACAT,KAAA,CAAAU,IAAA,oBAAAP,IAAA;QAAAQ,OAAA;UACA;QACA;MAAA,GAAAC,IAAA,CAAAC,GAAA;QACA;QACA,IAAAA,GAAA,CAAAX,IAAA,CAAAY,IAAA;UACA,KAAAC,QAAA;YACAC,OAAA,EAAAH,GAAA,CAAAX,IAAA,CAAAe,GAAA;YACAC,IAAA;UACA;UACA;UACAC,YAAA,CAAAC,OAAA,UAAAP,GAAA,CAAAX,IAAA,CAAAA,IAAA,CAAAmB,KAAA;UACA;UACA,KAAAC,MAAA,CAAAC,MAAA,YAAAV,GAAA,CAAAX,IAAA,CAAAA,IAAA,CAAAC,IAAA;UACA,KAAAqB,OAAA,CAAAC,IAAA;QACA;UACA,KAAAV,QAAA;YACAC,OAAA,EAAAH,GAAA,CAAAX,IAAA,CAAAe,GAAA;YACAC,IAAA;UACA;QACA;MACA;IACA;IACA;IACAV,SAAA;MACA,SAAAL,IAAA,CAAAC,QAAA;QACA,KAAAW,QAAA;UACAC,OAAA;UACAE,IAAA;QACA;QACA;MACA,gBAAAf,IAAA,CAAAC,QAAA,CAAAsB,MAAA,aAAAvB,IAAA,CAAAC,QAAA,CAAAsB,MAAA;QACA,KAAAX,QAAA;UACAC,OAAA;UACAE,IAAA;QACA;QACA;MACA,OACA;IACA;IACA;IACAT,QAAA;MACA,SAAAN,IAAA,CAAAE,QAAA;QACA,KAAAU,QAAA;UACAC,OAAA;UACAE,IAAA;QACA;QACA;MACA,gBAAAf,IAAA,CAAAE,QAAA,CAAAqB,MAAA,aAAAvB,IAAA,CAAAE,QAAA,CAAAqB,MAAA;QACA,KAAAX,QAAA;UACAC,OAAA;UACAE,IAAA;QACA;QACA;MACA,OACA;IACA;EACA;EACAS,QAAA;IACA;IACA,SAAAL,MAAA,CAAAM,KAAA,CAAAC,KAAA;MACA,KAAAP,MAAA,CAAAC,MAAA;MACA,KAAAC,OAAA,CAAAM,EAAA;IACA;IACA,KAAAC,SAAA;MACAC,QAAA,CAAAC,KAAA;IACA;EACA;AACA;AACA,eAAAhC,OAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}